<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple Computer//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
	<key>beforeRunningCommand</key>
	<string>nop</string>
	<key>command</key>
	<string>export PATH="$TM_SUPPORT_PATH/bin/CocoaDialog.app/Contents/MacOS:$PATH"

TMP_DIR=`mktemp -d /tmp/TextMate_svn_diff.XXXXXX` || exit 1
FILE="$TMP_DIR/$TM_FILENAME.diff"
PIPE="$TMP_DIR/pipe"

mkfifo "$PIPE"
CocoaDialog progressbar --indeterminate --title "Diff With Newest (HEAD)" --text "Contacting subversion serverâ€¦" &lt;"$PIPE" &amp;&gt;/dev/null &amp;

# associate file descriptor 3 with that pipe and send a character through the pipe
exec 3&lt;&gt; "$PIPE"
echo -n . &gt;&amp;3

"${TM_SVN:=svn}" diff -rHEAD "$TM_FILEPATH" &amp;&gt;"$FILE"

exec 3&gt;&amp;-
open -a TextMate "$FILE" &amp;

{ sleep 30; rm -rf "$TMP_DIR"; } &lt;/dev/null &amp;&gt;/dev/null &amp;</string>
	<key>input</key>
	<string>none</string>
	<key>keyEquivalent</key>
	<string>^A</string>
	<key>name</key>
	<string>Diff With Newest (HEAD)</string>
	<key>output</key>
	<string>discard</string>
	<key>uuid</key>
	<string>DF784C33-74D7-11D9-813D-000A95A89C98</string>
</dict>
</plist>
